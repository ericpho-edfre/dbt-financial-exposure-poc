version: 2

models:
  - name: stg_project_tracker
    description: >
      Bronze layer for Project Tracker data.
      This model processes raw project tracker data, cleans it, and removes duplicates based on the latest load date.
      It ensures that only the most recent record for each project is retained.
      The model handles NULL values and converts date fields appropriately.
      Source: raw.project_tracker_raw

    columns:
      - name: PROJECT_ID
        description: Unique identifier for the project.

      - name: PROJECT_NAME
        description: Name of the project.

      - name: LATITUDE
        description: Latitude coordinate of the project location.

      - name: LONGITUDE
        description: Longitude coordinate of the project location.

      - name: IS_PROJECT_EDF_OWNED
        description: Indicates whether the project is owned by EDF (true/false).

      - name: DEVELOPMENT_REGION
        description: Geographic region where the project is being developed.

      - name: CURRENT_PROJECT_STATUS
        description: Current status of the project (e.g., active, completed, planned).

      - name: TECHNOLOGY_CATEGORY
        description: Technology type used in the project (e.g., solar, wind).

      - name: CONTRACTED_CAPACITY_MW_DC
        description: Contracted capacity in megawatts (direct current).

      - name: CONTRACTED_CAPACITY_MW_AC
        description: Contracted capacity in megawatts (alternating current).

      - name: POI_CAPACITY_MW_AC
        description: Point-of-interconnection capacity in megawatts (alternating current).

      - name: COD_DATE
        description: Commercial Operation Date of the project.

      - name: EARLIEST_COD_DATE
        description: Earliest expected Commercial Operation Date.

      - name: LOAD_DATE
        description: Date when the record was loaded into the raw layer.
        
  - name: stg_sap_project
    description: >
      Bronze layer for SAP Project data.
      This model processes raw SAP project data, cleans it, and removes duplicates based on the latest load date.
      It ensures that only the most recent record for each project is retained.
      Source: raw.SAP_PROJ_RAW      
      Columns renaming performed based on https://leanx.eu/en/sap/table/proj.html      
    columns:
      - name: sap_client_id
        description: "SAP client identifier (renamed from MANDT)"
        data_type: varchar      
      - name: project_definition_internal
        description: "Internal project definition number"
        data_type: varchar        
      - name: project_definition
        description: "External project definition identifier"
        data_type: varchar
      - name: project_short_definition_line1
        description: "Short description of the project (first line)"
        data_type: varchar
      - name: LOAD_DATE
        description: "Timestamp when record was loaded into raw layer"
        data_type: timestamp
  - name: stg_sap_wbs
    description: >    
      Bronze layer for SAP WBS data. This model processes raw SAP PRPS (WBS) records, 
      cleans the data, and removes duplicates based on the latest LOAD_DATE. It ensures 
      that only the most recent record for each WBS is retained. 
      Columns renaming performed based on hhttps://leanx.eu/en/sap/table/prps.html
    columns:
      - name: sap_client_id
        description: SAP client ID (MANDT).
      - name: wbs_id
        description: Work Breakdown Structure (WBS) element internal ID (PSPNR).
      - name: wbs_other_id
        description: External or alternate WBS element ID (POSID).
      - name: project_short_definition_line1
        description: Project short description (line 1) (POST1).
      - name: sap_proj_id
        description: SAP project definition ID (PSPHI).
      - name: wbs_element_short_identification
        description: Short identification key for the WBS element (POSKI).
      - name: project_tracker_project_id
        description: Foreign key to the third-party Project Tracker system (USR03).
      - name: LOAD_DATE
        description: Load timestamp from the raw layer. Used to identify the most recent record.